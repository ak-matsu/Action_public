name: 30min_ts

on:
  schedule:
    - cron: '*/30 * * * *'  # 30åˆ†ã”ã¨ã«å®Ÿè¡Œ
  workflow_dispatch:

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send main message to Slack
        id: send_slack_message
        uses: rtCamp/action-slack-notify@v2
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
        with:
          message: "ğŸ“¢ å®šæœŸé€šçŸ¥: GitHub Pages ã®æ›´æ–°æƒ…å ±"
          color: "#36a64f"

      - name: Extract timestamp
        run: |
          echo "SLACK_TS=$(jq -r '.ts' <<< '${{ steps.send_slack_message.outputs.response }}')" >> $GITHUB_ENV

      - name: Reply in Thread
        run: |
          curl -X POST -H "Authorization: Bearer ${{ secrets.SLACK_BOT_TOKEN }}" \
               -H "Content-type: application/json" \
               --data '{
                 "channel": "CLR0Z1NF9",
                 "text": "ğŸ”„ è¿½åŠ æƒ…å ±: æœ€æ–°ã®æ›´æ–°å†…å®¹ã¯ã“ã¡ã‚‰ã€‚",
                 "thread_ts": "'$SLACK_TS'"
               }' \
               https://slack.com/api/chat.postMessage
